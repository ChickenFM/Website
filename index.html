<html>
    <head>
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link rel="stylesheet" type="text/css" href="style.css">
            <title>Chicken FM &bull; Your Chicken Station</title>
            <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300">
            <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">  
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
            <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pnotify/3.0.0/pnotify.js?1568124206"></script>
            <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
            <script type="text/javascript" src="pnotify/dist/iife/PNotify.js"></script>
            <script type="text/javascript" src="pnotify/dist/iife/PNotifyButtons.js"></script>
            <link href="pnotify/dist/PNotifyBrightTheme.css" rel="stylesheet" type="text/css" />
            <script type="text/javascript" src="/chickenfm.js"></script>
            <link rel="manifest" href="/manifest.json">

            <!--Meta tags-->
            <meta name="apple-mobile-web-app-capable" content="yes">
            <meta name="apple-mobile-web-app-status-bar-style" content="black">
            <meta name="apple-mobile-web-app-title" content="Weather PWA">
            <link rel="apple-touch-icon" href="/images/icons/icon-152x152.png">
            <meta name="theme-color" content="#0034FF" />
            <!--Thanks to @DawsonX#9322 on discord :)-->
             <meta name="description" content="This is ChickenFM, sotp listening to bad music or else you're bald">
             <meta property="og:description" content="This is ChickenFM, sotp listening to bad music or else you're bald">
             <meta name="author" content="ChickenFM">
             <!--Register service worker-->
             <script>// CODELAB: Register service worker.
              if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                  navigator.serviceWorker.register('/service-worker.js')
                      .then((reg) => {
                        console.log('Service worker registered.', reg);
                      });
                });
              };</script>
            <!--Pnotify to notify you about the developement hihi-->
            <script>function showStackTopCenter(type) {
              if (typeof window.stackTopCenter === 'undefined') {
                window.stackBottomRight = {
                  'dir1': 'up',
                  'dir2': 'left',
                  'firstpos1': 25,
                  'firstpos2': 25
                };
              }
              var opts = {
                title: 'Over Here',
                text: "Check me out. I'm in a different stack.",
                stack: window.stackBottomRight
              };
              switch (type) {
                case 'error':
                  opts.title = 'Oh No';
                  opts.text = 'Watch out for that water tower!';
                  opts.type = 'error';
                  break;
                case 'info':
                  opts.title = 'Still in developement';
                  opts.text = 'ChickenFM.ga is still in developement. If you experience any issues, send a DM to trashcan#2971 on discord.';
                  opts.type = 'info';
                  break;
                case 'success':
                  opts.title = 'Good News Everyone';
                  opts.text = "I've invented a device that bites shiny metal asses.";
                  opts.type = 'success';
                  break;
              }
              PNotify.alert(opts);
            }
            </script>
            <!-- <iframe src="https://radio.viberadio.pw/public/chickenfm" frameborder="0" allowtransparency="true" style="background-image: url('https://pbs.twimg.com/media/D_9RmzaWwAAzhWM?format=jpg&name=900x900'); width: 100%; height: 100%; min-height: 100%;"></iframe> --> 


            <script type="text/javascript">
                // Popup window code
                function newPopup(url) {
                        popupWindow = window.open(
                                url,'popUpWindow','height=328,width=570,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,directories=no,status=yes')
                }
                </script>

 
    </head>
    <body onload="playing()">

                    <div class="topnav" id="myTopnav">
                        <a href="index.html" class="active">Home</a>
                        <a href="#" id="myBtn">Request songs</a>
                        <a href="JavaScript:newPopup('popup.html');">Popup Player</a>
                        <a href="#">Discord (coming soon)</a>
                        <a href="#">Suggest songs (coming soon)</a>
                        <a href="javascript:void(0);" class="icon" onclick="topnav()">
                          <i class="fa fa-bars"></i>
                        </a>
                    </div>
                  <div class="empty"></div>
                    <script>
                        function topnav() {
                          var x = document.getElementById("myTopnav");
                          if (x.className === "topnav") {
                            x.className += " responsive";
                          } else {
                            x.className = "topnav";
                          }
                        }
                        </script>
            <!-- The Modal -->
              <div id="myModal" class="songreq">

                <!-- Modal content -->
                <div class="songreq-content">
                  <div class="songreq-header">
                    <span class="close">&times;</span>
                    <h2>Request songs</h2>
                  </div>
                  <div class="songreq-body">
                        <iframe src="http://157.245.33.91/public/chickenfm/embed-requests" frameborder="0" allowtransparency="true" style="width: 100%; height: 75%; border: 0;"></iframe>
                  </div>
                  <div class="songreq-footer">
                    <h3>UwU</h3>
                  </div>
                </div>
              
              </div>
                    <script>
                                // Get the modal
                                var modal = document.getElementById("myModal");
                                
                                // Get the button that opens the modal
                                var btn = document.getElementById("myBtn");
                                
                                // Get the <span> element that closes the modal
                                var span = document.getElementsByClassName("close")[0];
                                
                                // When the user clicks the button, open the modal 
                                btn.onclick = function() {
                                  modal.style.display = "block";
                                }
                                
                                // When the user clicks on <span> (x), close the modal
                                span.onclick = function() {
                                  modal.style.display = "none";
                                }
                                
                                // When the user clicks anywhere outside of the modal, close it
                                window.onclick = function(event) {
                                  if (event.target == modal) {
                                    modal.style.display = "none";
                                  }
                                }
                                </script>


                                
            <div class="player player-body">
              <!--<div id="coverimg" class="djimage"></div>-->
              <img class="djimage" id="coverimg" style="float:left;" src="s"></img>
              <!--<h3 style="color:#ffffff;">ChickenFM is unfortunately down. We will be back on air as soon as possible</h3>-->
              <!--<iframe src="http://157.245.33.91/public/chickenfm/embed" frameborder="0" allowtransparency="false" style="width: 100%; min-height: 150px; border: 0;"></iframe>-->
              <div class="nowplaying">
                <span class="dj" id="dj" style="float:right; color:white;">Now Playing:</span><br>
                <h3 id="track" style="float:right; color:white;">-</h3><br>
                <h5 id="artist" style="float:right; color:white;">-</h5>
              </div>
              <!--<video controls="" autoplay="" name="media"><source src="http://157.245.33.91:8000/radio.mp3?1567750028" type="audio/mpeg"></video>-->
                <audio id="player" autoplay="false" volume="0"><source src="http://157.245.33.91:8000/radio.mp3?1567869927" type="audio/mpeg"></audio>
                  <div class="loginbutton togglr" style="color:white;width:fit-content;">
                      <i class="togl fa fa-play" style="text-align: center;"></i>
                   </div>
              </div>  

              
              <script type="text/javascript">
              

                function playing() {
                  $.getJSON('http://157.245.33.91/api/nowplaying/1', (data) => {
                  var song = data.now_playing.song.artist + " - " +data.now_playing.song.title;
                  var track = data.now_playing.song.title;
                  var artist = data.now_playing.song.artist;
                  document.getElementById("track").innerHTML = track.toString();
                  document.getElementById("artist").innerHTML = artist.toString();
                  //var dj = data.live.streamer_name + ":";
                  var djstat = data.live.streamer_name;
                  document.getElementById("dj").innerHTML = dj.toString()
                  if(djstat == "") {
                    document.getElementById("dj").innerHTML = "AutoDJ";
                  } else {
                    document.getElementById("dj").innerHTML = dj.toString();
                  } 

                  coversrc = data.now_playing.song.art;
                  //imagesrc = cover.toString();
                  //imagehtml = '<img src="'+imagesrc+'"></img>'
                  image = document.getElementById('coverimg');
                  image.src = coversrc.toString();
                  //image.innerHTML = imagehtml.toString()
                  //image.innerHTML = cover.toString();
                 
                 });
                 setTimeout(playing, 5000);
               } 	playing();
              
               var stream = document.getElementById("player");
               stream.pause()
               //loadRadio()
               showStackTopCenter('info');
              
              $('.togglr').click(function(){
                toggleRadio();
              });
              function toggleRadio(){
                if (stream.paused){
                  playRadio();
                } else {
                  pauseRadio();
                }
              }
              function playRadio(){
                stream.volume = 0; 
              
                $('.togl').attr("class", "togl fas fa-circle-notch fa-spin");
                stream.play().then(function() {
                  stream.volume = 0.6;
                  $('.togl').attr("class", "togl fa fa-pause");
                  //Pnotify
                  var notice = PNotify.success({
                  title: 'ChickenFM',
                  text: 'ChickenFM started playing!',
                  modules: {
                      Buttons: {
                        closer: true,
                        sticker: false,
                        closerHover: false,
                        stickerHover: false
                      }
                    }
                  });
                  notice.on('click', function() {
                    notice.close();
                  });
              
                }).catch(function() {
                  pauseRadio();
                });
              }
              
              function pauseRadio(){
                stream.pause();
                stream.volume = 0;
                $('.togl').attr("class", "togl fa fa-play");
                //Pnotify
                var notice = PNotify.success({
                  title: 'ChickenFM',
                  text: 'ChickenFM stopped playing',
                  modules: {
                      Buttons: {
                        closer: true,
                        sticker: false,
                        closerHover: false,
                        stickerHover: false
                      }
                    }
                  });
                  notice.on('click', function() {
                    notice.close();
                  });
              }
              

              
             /* $(".reqln").click(function(){
                $(".modal").show()
              })*/
              </script>
        
    </body>
</html>